# 前言

起因：模型测试，部分条码检测得分较低，偶尔出现截断现象，dm码残缺码误识率较高。

### 模型检测可视化结果

<center><img src="https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-%E8%83%8C%E6%99%AF%E8%AF%AF%E6%A3%80.jpg" alt="背景误检" style="zoom: 50%;" align=lift/><img src="https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-%E6%9D%A1%E7%A0%81%E6%88%AA%E6%96%AD.jpg" alt="条码截断" style="zoom: 50%;" align=center/><img src="https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-DM%E6%AE%8B%E7%BC%BA%E7%A0%81%E8%AF%AF%E6%A3%80.jpg" alt="DM残缺码误检" style="zoom: 30%;" align=right/></center>

### 实际样本标注

<center><img src="https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-%E6%9D%A1%E7%A0%81%E6%88%AA%E6%96%AD%E9%94%99%E8%AF%AF%E6%A0%B7%E6%9C%AC.png" alt="条码截断错误样本" style="zoom: 25%;" align=lift/><img src="https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-%E6%9D%A1%E7%A0%81%E6%A0%87%E6%B3%A8%E9%94%99%E8%AF%AF%E6%A0%B7%E6%9C%AC.png" alt="条码标注错误样本" style="zoom: 25%;" align=center/><img src="https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-DM%E6%AE%8B%E7%BC%BA%E7%A0%81%E9%94%99%E8%AF%AF%E6%A0%B7%E6%9C%AC.png" alt="DM残缺码错误样本" style="zoom: 25%;" align=right/><img src="https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-%E9%9A%BE%E6%A0%87%E6%B3%A8%E6%A0%B7%E6%9C%AC.png" alt="难标注样本" style="zoom: 25%;" align=right/></center>

存在标注不规范问题，以及数据增强导致标注框错位现象

# 初步筛选结果（非label数）

| 数据集  | 现有图片数 | 原有图片数 |     筛选比例     |
| :-----: | :--------: | :--------: | :--------------: |
|  train  |   22593    |   24330    |       7.1%       |
|   val   |    2441    |    2701    |       9.6%       |
|  test   |    2802    |    3112    |      9.96%       |
| **sum** | **27836**  | **30143**  | (2307) **7.65%** |

| 错误分布 |  dm  |  qr  | bar  | multicode |
| :------: | :--: | :--: | :--: | :-------: |
|   数量   |  33  | 279  | 1000 |    995    |

其中<u>多类</u>主要是由**bar标注框错位**导致。

---

# 条码标注参考准则

分析组成，结合各自纠错能力来规范标注准则

## 1. DM码

### 1.1 基本组成

![DM码组成](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-DM%E7%A0%81%E7%BB%84%E6%88%90.jpg)

### 1.2 纠错能力

![DM码纠错能力](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-DM%E7%A0%81%E7%BA%A0%E9%94%99%E8%83%BD%E5%8A%9B.jpg)

## 2.二维码qrcode

### 2.1 基本组成

![二维码组成](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-%E4%BA%8C%E7%BB%B4%E7%A0%81%E7%BB%84%E6%88%90.png)

### 2.2 纠错能力

![二维码遮挡](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-%E4%BA%8C%E7%BB%B4%E7%A0%81%E9%81%AE%E6%8C%A1.jpg)



## 3.条形码barcode

### 3.1 基本组成

![条形码组成](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-%E6%9D%A1%E5%BD%A2%E7%A0%81%E7%BB%84%E6%88%90.png)

### 3.2 纠错能力

保留起始符和终止符，各数据符粗细清晰。即不兼容截断。

<center><img src="https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-%E6%9D%A1%E5%BD%A2%E7%A0%81%E8%B4%AF%E7%A9%BF.jpg" alt="二维码贯穿" style="zoom: 120%;" align=lift/><img src="https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-%E6%9D%A1%E5%BD%A2%E7%A0%81%E9%81%AE%E6%8C%A1.jpg" alt="二维码遮挡" style="zoom: 120%;" align=right/></center>

---

### 4 小结

DM码位置标识

![DM码位置标识](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-DM%E7%A0%81%E4%BD%8D%E7%BD%AE%E6%A0%87%E8%AF%86.jpg)

二维码位置标识

![二维码位置标识](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E6%9D%A1%E7%A0%81%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86%E6%96%B9%E9%92%88-%E4%BA%8C%E7%BB%B4%E7%A0%81%E4%BD%8D%E7%BD%AE%E6%A0%87%E8%AF%86.png)

各码需要留有**空白区**，能准确**识别出位置标识**，内容部分具备不同程度的纠错度。



结合[VOC标注准则](http://host.robots.ox.ac.uk/pascal/VOC/voc2012/guidelines.html)的大概提要：

1. 被遮挡5%的不标注
2. 模糊但外形完整(不含拖影)需要标注
3. 玻璃后的物体属于遮蔽
4. 图片中所有物体必须标注，不易标注样本应当去除

为此，对原有数据集重新整理出以下四类

1. lack	——存在类别未标注
2. error  ——标注框超出边界、标注有误&不准确
3. detele ——样本重复 & 属于不易标注样本（过度倾斜以及抖动模糊）
4. hard ——存在争议样本，主要为其他类型条码或
5. nagative ——残缺码难样本，后续可以新增为背景类

---

## 参考样例

所有码必须标出，一框一个码，框周围视情况留空，保证框内码能识别。

### 二维码



### 条形码



P.S 对于移动设备上(隔着玻璃)扫码，需要增加该场景样本，否则建议删除；对于难样本可以考虑用蒙版遮挡。





